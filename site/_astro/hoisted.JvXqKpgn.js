import"./hoisted.DOw85ys1.js";import{$ as r}from"./store.8pX9dcuw.js";import{d as y}from"./player.C9XHYsCf.js";const N=document.querySelectorAll(".av-file");r.listen((a,t,o)=>{if(!o||!a[o])return null;N.forEach(i=>{const n=i.getAttribute("data-file-id");a[o].avFileUuid===n?i.classList.remove("hidden"):i.classList.add("hidden")})});const v=a=>{a.classList.add("hidden"),a.classList.remove("flex")},h=a=>{a.classList.add("flex"),a.classList.remove("hidden")},m="!bg-blue-hover",b=document.querySelectorAll(".playAnnotation");for(let a=0;a<b.length;a++){const t=b[a];if(t.dataset.start&&t.dataset.playerId){const o=r.get()[t.dataset.playerId]?.annotationStarts;o&&(o.push({start:Math.floor(Number(t.dataset.start)),end:Math.floor(Number(t.dataset.end))>Math.floor(Number(t.dataset.start))?Math.floor(Number(t.dataset.end)):void 0,playerId:t.dataset.playerId}),r.setKey(t.dataset.playerId,{...r.get()[t.dataset.playerId]||y,annotationStarts:o})),t.addEventListener("click",()=>{const i=t.dataset.playerId||"null";r.setKey(i,{...r.get()[i]||y,position:Number(t.dataset.start),seekTo:Number(t.dataset.start),isPlaying:!0})})}}r.listen((a,t,o)=>{if(!o)return null;const i=o.split(".")[0],n=a[i],l=document.querySelector(`.eventContainer[data-player-id="${i}"]`);if(!l)return console.error(`No event container found for ${o}`),null;const d=l.querySelectorAll(".annotationNode"),c=l.querySelectorAll(".annotationTags"),f=n.annotationStarts?.filter(e=>e.playerId===o),u=f?.findIndex((e,s)=>typeof e.end=="number"?e.start<=n.position&&e.end>n.position:s<f.length-1?e.start<=n.position&&f[s+1].start>n.position:e.start<=n.position);if(typeof u=="number"&&u>=0){const e=d[u];if(e){if(n.autoScroll)if(n.isEmbed){const s=document.querySelector(`.videoAnnotationContainer[data-player-id="${o}"]`),p=e.offsetTop;s?s.scroll({top:p-s.clientHeight,behavior:"smooth"}):l.scroll({top:p-l.clientHeight/3,behavior:"smooth"})}else e.scrollIntoView({behavior:"smooth",block:"end"});e.classList.add(m)}for(let s=0;s<d.length;s++)s!==u&&d[s].classList.remove(m)}if(n.showTags!==t[i]?.showTags)if(n.showTags)for(let e=0;e<c.length;e++)h(c[e]);else for(let e=0;e<c.length;e++)v(c[e]);for(const e of d){const s=e.getAttribute("data-uuid");s&&n.filteredAnnotations.includes(s)?h(e):v(e)}});const g=document.querySelectorAll(".event-detail-tab-button");g.forEach(a=>{const t=a.id.replace("av-tab-",""),o=a.getAttribute("data-player-id");a.addEventListener("click",()=>{r.setKey(`${o}.avFileUuid`,t)})});r.listen(a=>{if(!a)return null;g.forEach(t=>{const o=t.id.replace("av-tab-",""),i=t.getAttribute("data-player-id");r.get()[i].avFileUuid===o?t.classList.add("event-detail-selected-tab"):t.classList.remove("event-detail-selected-tab")})});
